{"version":3,"names":["$","document","ready","$preview","appendTo","$img","currentImgIndex","scale","isDragging","startX","startY","imgStartLeft","imgStartTop","dx","dy","animationFrameId","images","initPreview","src","index","attr","on","alert","css","transform","position","fadeIn","handleKeydown","closePreview","fadeOut","off","switchImage","direction","total","length","nextSrc","preloadNext","preloadPrev","Image","zoomTimeout","zoomImage","delta","clearTimeout","setTimeout","Math","max","min","dragImage","e","pageX","pageY","requestAnimationFrame","left","top","stopDrag","is","key","$contentImages","stopPropagation","this","splice","target","window","preventDefault","originalEvent","deltaY","parseFloat"],"sources":["preview copy.js.map"],"sourcesContent":["$(document).ready(function () {\n  const $preview = $(\"<div id='image-preview'></div>\").appendTo(\"#main\");\n  const $img = $(\"<img>\").appendTo($preview);\n  let currentImgIndex = 0;\n  let scale = 1;\n  let isDragging = false;\n  let startX = 0;\n  let startY = 0;\n  let imgStartLeft = 0;\n  let imgStartTop = 0;\n  let dx = 0;\n  let dy = 0;\n  let animationFrameId = null;\n  const images = [];\n\n  // 初始化图片预览\n  function initPreview(src, index) {\n    $img.attr(\"src\", src).on(\"error\", () => alert(\"图片加载失败\"));\n    currentImgIndex = index;\n    scale = 1;\n    $img.css({\n      transform: `scale(${scale})`,\n      position: \"absolute\"\n    });\n    $preview.fadeIn(300);\n    enableKeyboardShortcuts();\n  }\n\n  // 关闭图片预览\n  function closePreview() {\n    $preview.fadeOut(300);\n    disableKeyboardShortcuts();\n  }\n\n  // 切换图片\n  function switchImage(direction) {\n    const total = images.length;\n    if (total === 0) return;\n    scale = 1;\n    currentImgIndex = (currentImgIndex + direction + total) % total;\n    const nextSrc = $(images[currentImgIndex]).attr(\"src\");\n    $img.attr(\"src\", nextSrc);\n\n    // 预加载相邻图片\n    const preloadNext = $(images[(currentImgIndex + 1) % total]).attr(\"src\");\n    const preloadPrev = $(images[(currentImgIndex - 1 + total) % total]).attr(\"src\");\n    new Image().src = preloadNext;\n    new Image().src = preloadPrev;\n  }\n\n  // 缩放图片\n  let zoomTimeout;\n  function zoomImage(delta) {\n    clearTimeout(zoomTimeout);\n    zoomTimeout = setTimeout(() => {\n      scale = Math.max(0.1, Math.min(3, scale + delta));\n      $img.css({\n        transform: `scale(${scale})`\n      });\n    }, 50);\n  }\n\n  // 开始拖拽\n  function startDrag(e) {\n    if (e.pageX !== 0 && e.pageY !== 0) {\n      isDragging = true;\n      startX = e.pageX;\n      startY = e.pageY;\n      imgStartLeft = parseFloat($img.css(\"left\")) || 0;\n      imgStartTop = parseFloat($img.css(\"top\")) || 0;\n      $img.css(\"cursor\", \"grabbing\");\n      $(document).on(\"mousemove\", dragImage);\n      $(document).on(\"mouseup\", stopDrag);\n      e.preventDefault();\n    } else {\n      closePreview();\n    }\n  }\n\n  // 拖拽图片\n  function dragImage(e) {\n    if (!isDragging) return;\n    dx = e.pageX - startX;\n    dy = e.pageY - startY;\n    if (!animationFrameId) {\n      animationFrameId = requestAnimationFrame(() => {\n        $img.css({\n          left: `${imgStartLeft + dx}px`,\n          top: `${imgStartTop + dy}px`\n        });\n        animationFrameId = null;\n      });\n    }\n  }\n\n  // 停止拖拽\n  function stopDrag() {\n    isDragging = false;\n    $img.css(\"cursor\", \"grab\");\n    $(document).off(\"mousemove\", dragImage);\n    $(document).off(\"mouseup\", stopDrag);\n  }\n\n  // 启用键盘快捷键\n  function enableKeyboardShortcuts() {\n    $(document).on(\"keydown\", handleKeydown);\n  }\n\n  // 禁用键盘快捷键\n  function disableKeyboardShortcuts() {\n    $(document).off(\"keydown\", handleKeydown);\n  }\n\n  // 键盘事件处理\n  function handleKeydown(e) {\n    if ($preview.is(\":visible\")) {\n      switch (e.key) {\n        case \"Escape\":\n          closePreview();\n          break;\n        case \"ArrowLeft\":\n        case \"ArrowUp\":\n          switchImage(-1);\n          break;\n        case \"ArrowRight\":\n        case \"ArrowDown\":\n          switchImage(1);\n          break;\n        case \"+\":\n          zoomImage(0.1);\n          break;\n        case \"-\":\n          zoomImage(-0.1);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  // 绑定缩略图点击事件\n  const $contentImages = $(\".content img:not(#image-preview img, .footer img)\");\n  $(\"div.content\").on(\"click\", \"img:not(#image-preview img)\", function (e) {\n    e.stopPropagation();\n    const index = $contentImages.index(this);\n    images.splice(0, images.length, ...$contentImages);\n    initPreview(this.src, index);\n  });\n\n  // 预览框交互\n  $preview.on(\"click\", function (e) {\n    if (e.target === $img[0]) return;\n    closePreview();\n  });\n  $(window).on(\"resize\", closePreview);\n  $preview.on(\"wheel\", function (e) {\n    e.preventDefault();\n    const delta = e.originalEvent.deltaY > 0 ? -0.1 : 0.1;\n    zoomImage(delta);\n  });\n  $preview.on(\"mousedown\", startDrag);\n});"],"mappings":"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","ignoreList":[]}