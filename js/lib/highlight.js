mixins.highlight={data:()=>({copying:!1,supportedLanguages:["bash","javascript","python","html","css","batch"],cdnBase:"https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/es/languages/"}),created(){hljs.configure({ignoreUnescapedHTML:!0,languages:this.supportedLanguages}),this.renderers.push(this.highlight)},methods:{async loadLanguage(e){try{const a=await import(`${this.cdnBase}${e}.min.js`);return hljs.registerLanguage(e,a.default),!0}catch(a){return console.warn(`加载语言模块 ${e} 失败:`,a),!1}},getLanguageClass(e){const a=e.querySelector("code")||e;return[...a.classList].find((e=>e.startsWith("language-")))?.replace("language-","")||"plaintext"},async highlight(){const e=document.querySelectorAll("pre");await Promise.all(Array.from(e).map((async e=>{const a=e.textContent,t=this.getLanguageClass(e);hljs.getLanguage(t)||await this.loadLanguage(t)||console.warn(`语言 ${t} 不支持，使用纯文本显示`);try{const s=hljs.highlightAuto(a,this.supportedLanguages).value;e.innerHTML=this.generateCodeHtml(s,t),this.addLineNumbers(e),this.addCopyHandler(e,a)}catch(e){console.error("代码高亮失败:",e)}})))},generateCodeHtml:(e,a)=>`\n                <code class="code-content hljs">${e}</code>\n                <div class="language">${a}</div>\n                <div class="copycode" aria-label="复制代码">\n                    <i class="fa-solid fa-copy"></i>\n                    <i class="fa-solid fa-check"></i>\n                </div>\n            `,addLineNumbers(e){if(window.hljsLineNumbersBlock){const a=e.querySelector(".code-content");window.hljsLineNumbersBlock(a,{singleLine:!0})}},addCopyHandler(e,a){const t=e.querySelector(".copycode");t.addEventListener("click",(async()=>{if(!this.copying){this.copying=!0,t.classList.add("copied");try{await navigator.clipboard.writeText(a),await this.sleep(1500)}catch(e){console.error("复制失败:",e);const t=document.createElement("textarea");t.value=a,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}finally{t.classList.remove("copied"),this.copying=!1}}}))},sleep:e=>new Promise((a=>setTimeout(a,e)))}};
//# sourceMappingURL=search.js.map